<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Management</title>
    <!-- Import Firebase Libraries -->
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-auth.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="loginDiv">
        <h2 id="loginTitle">Login</h2>
        <input type="text" id="username" placeholder="Username"><br>
        <input type="password" id="password" placeholder="Password"><br>
        <button id="loginButton">Login</button>
        <p id="loginMessage"></p>
    </div>

    <div id="tablesDiv" style="display: none;">
        <h2>Members Management</h2>
        <div id="A1">
            <h3>Team A1</h3>
            <div id="membersA1"></div>
            <input type="text" id="teamA1Rank" placeholder="Rank">
            <input type="text" id="teamA1FirstName" placeholder="First Name">
            <input type="text" id="teamA1LastName" placeholder="Last Name">
            <input type="text" id="teamA1Remark" placeholder="Remark">
            <button onclick="addMember('A1')">Add Member</button>
        </div>
        <div id="A2">
            <h3>Team A2</h3>
            <div id="membersA2"></div>
            <input type="text" id="teamA2Rank" placeholder="Rank">
            <input type="text" id="teamA2FirstName" placeholder="First Name">
            <input type="text" id="teamA2LastName" placeholder="Last Name">
            <input type="text" id="teamA2Remark" placeholder="Remark">
            <button onclick="addMember('A2')">Add Member</button>
        </div>
        <div id="B1">
            <h3>Team B1</h3>
            <div id="membersB1"></div>
            <input type="text" id="teamB1Rank" placeholder="Rank">
            <input type="text" id="teamB1FirstName" placeholder="First Name">
            <input type="text" id="teamB1LastName" placeholder="Last Name">
            <input type="text" id="teamB1Remark" placeholder="Remark">
            <button onclick="addMember('B1')">Add Member</button>
        </div>
        <div id="B2">
            <h3>Team B2</h3>
            <div id="membersB2"></div>
            <input type="text" id="teamB2Rank" placeholder="Rank">
            <input type="text" id="teamB2FirstName" placeholder="First Name">
            <input type="text" id="teamB2LastName" placeholder="Last Name">
            <input type="text" id="teamB2Remark" placeholder="Remark">
            <button onclick="addMember('B2')">Add Member</button>
        </div>
    </div>
    
    <script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyBNGdzNvVU9hBF6xU_TyGEihhwjy4_URtA",
    authDomain: "tmtb-83013.firebaseapp.com",
    projectId: "tmtb-83013",
    storageBucket: "tmtb-83013.appspot.com",
    messagingSenderId: "641087841158",
    appId: "1:641087841158:web:dbfdbeff443565b36b8207"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
</script>

        let currentUser = null;

        const loadMembers = (team) => {
            db.collection(team).onSnapshot((snapshot) => {
                const members = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                renderMembers(`members${team}`, members);
            });
        };

        const renderMembers = (elementId, members) => {
            const memberDiv = document.getElementById(elementId);
            memberDiv.innerHTML = ''; // Clear the existing members
            members.forEach(member => {
                const memberElement = document.createElement('div');
                memberElement.innerHTML = `
                    <strong>${member.rank}:</strong> ${member.firstName} ${member.lastName} 
                    <em>${member.remark}</em>
                    <button onclick="deleteMember('${member.id}', '${elementId.charAt(elementId.length - 1)}')">Delete</button>
                `;
                memberDiv.appendChild(memberElement);
            });
        };

        const addMember = async (team) => {
            const rank = document.getElementById(`team${team}Rank`).value;
            const firstName = document.getElementById(`team${team}FirstName`).value;
            const lastName = document.getElementById(`team${team}LastName`).value;
            const remark = document.getElementById(`team${team}Remark`).value;

            if (!rank || !firstName || !lastName || !remark) return;

            await db.collection(team).add({ rank, firstName, lastName, remark });
            document.getElementById(`team${team}Rank`).value = ''; // Clear input fields
            document.getElementById(`team${team}FirstName`).value = '';
            document.getElementById(`team${team}LastName`).value = '';
            document.getElementById(`team${team}Remark`).value = '';
        };

        const deleteMember = async (memberId, team) => {
            await db.collection(team).doc(memberId).delete();
        };

        const login = () => {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            // Simple username validation
            if (username === 'admin' && password === 'admin') {
                currentUser = 'admin';
                showInputFields(true);
                showAddButtons(true);
            } else if (username === 'viewer' && password === 'viewer') {
                currentUser = 'viewer';
                showInputFields(false);
                showAddButtons(false);
            } else {
                document.getElementById('loginMessage').innerText = 'Invalid username or password.';
                return;
            }

            // Hide the login section
            document.getElementById('loginDiv').style.display = 'none';
            document.getElementById('tablesDiv').style.display = 'block';

            // Load team members
            loadMembers('A1');
            loadMembers('A2');
            loadMembers('B1');
            loadMembers('B2');
        };

        const showInputFields = (show) => {
            // You can implement additional logic based on roles if needed
        };

        const showAddButtons = (show) => {
            // Show or hide add buttons based on user role
        };

        document.getElementById('loginButton').addEventListener('click', login);
    </script>
</body>
</html>